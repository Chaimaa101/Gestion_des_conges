<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="shortcut icon" href="../Images/icon.png" type="image/x-icon">
    <link rel="stylesheet" href="../Style/style.css">
    <title>Demande de Congé</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>

<body class=" bg-gray-100 overflow-x-hidden">

    <main class="mainContent ml-64 min-h-screen flex py-8 ">
        <div class="container max-w-6xl mx-auto px-4">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-xl shadow-md p-6 mb-6 card">
                        <h1 class="text-2xl font-bold text-gray-800 mb-2">Nouvelle demande de congé</h1>
                        <p class="text-gray-600 mb-6">Remplissez le formulaire ci-dessous pour soumettre votre demande
                            de congé.</p>

                        <form class="add space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-gray-700 mb-2 font-medium">Date de début</label>
                                    <input type="date" name="startDate"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">

                                </div>
                                <div>
                                    <label class="block text-gray-700 mb-2 font-medium">Date de fin</label>
                                    <input type="date" name="endDate"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
                                </div>
                            </div>

                            <div>
                                <label class="block text-gray-700 mb-2 font-medium">Type de congé</label>
                                <select name="congeType"
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
                                    <option value="Congés payés">Congés payés</option>
                                    <option value="RTT">RTT</option>
                                    <option value="Congés maladie">Congés maladie</option>
                                    <option value="Sans solde">Congés sans solde</option>
                                    <option value="Congés maternité">Congés maternité</option>
                                    <option value="Autre">Autre</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-gray-700 mb-2 font-medium">Justification</label>
                                <textarea rows="4" name="justification"
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                                    placeholder="La raison de votre demande"></textarea>
                            </div>
                            <div class="bg-red-50 border border-red-200 rounded-xl p-5 card">
                                <h2 class="text-lg font-semibold text-orange-800 mb-2 flex items-center">
                                    <i class="fas fa-info-circle mr-2"></i> Information importante
                                </h2>
                                <p class="text-orange-700">
                                    Votre demande sera transmise à votre manager pour validation. Vous recevrez une
                                    notification par email une fois la décision prise.
                                </p>
                            </div>
                            <div class=" space-x-4 pt-4">
                                <button type="submit"
                                    class="px-6 py-3 bg-orange-400 text-white rounded-lg font-medium hover:bg-orange-700">
                                    Soumettre
                                </button>
                                <button type="reset"
                                    class="px-6 py-3 bg-orange-100 text-gray-700 rounded-lg font-medium hover:bg-orange-300 ">
                                    Réinitialiser
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="lg:col-span-1">
                    <div class="bg-white rounded-xl shadow-md p-6 pb-8 card">
                        <h2 class="text-xl font-bold text-gray-800 mb-6">Mes dernières demandes</h2>

                        <div class="userLeaves space-y-5">
                          
                            
                        </div>
                        <a class="text-gray-500 float-right m-1" href="list_leaves.html">Show more <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </main>
<script src="../Script/script.js" defer></script>
<script>
    const userLeavesContainer = document.querySelector('.userLeaves');
    const user = 1; 


    loadRecentLeaves();

    async function loadRecentLeaves() {
        try {
            const response = await axios.get(`http://localhost:4000/conges?id_employee=${user}&limit=3`);
            const leaves = response.data;
            
            userLeavesContainer.innerHTML = '';
            
            if (leaves.length === 0) {
                userLeavesContainer.innerHTML = `
                    <div class="text-center py-4 text-gray-500">
                        Aucune demande de congé récente
                    </div>
                `;
                return;
            }
            
            leaves.forEach(conge => {
                const leaveElement = document.createElement('div');
                leaveElement.innerHTML= `
                  <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex justify-between items-start mb-3">
                            <h3 class="font-semibold text-gray-800">${conge.type_conge}</h3>
                            ${conge.status_conge === "approuvé"
                            ? `<span class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">
                                <i class="fas fa-check mr-1"></i> Approuvé</span>`
                            : conge.status_conge === "refusé"
                                ? `<span class="px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs">
                                <i class="fas fa-times mr-1"></i> Refusé</span>`
                                : `<span class="px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs">
                                <i class="fas fa-clock mr-1"></i> En attente</span>`
                        }
                        </div>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div class="text-gray-500">Début:</div>
                            <div class="text-gray-800 font-medium">${conge.date_debut}</div>
                            <div class="text-gray-500">Fin:</div>
                            <div class="text-gray-800 font-medium">${conge.date_fin}</div>
                            <div class="text-gray-500">Durée:</div>
                            <div class="text-gray-800 font-medium">${conge.duree} jours</div>
                        </div>
                        
                    </div>
                `

                userLeavesContainer.appendChild(leaveElement);
    
            });
        } catch (error) {
            console.error('Error loading recent leaves:', error);
            userLeavesContainer.innerHTML = `
                <div class="text-center py-4 text-red-500">
                    Erreur lors du chargement des demandes
                </div>
            `;
        }
    }

   
    
</script>

</body>

</html>